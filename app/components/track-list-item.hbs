<div 
  class="pointer {{if @track.isMaster "ph4" "ph3"}} bb b--silver {{if @isActive "bg-yellow" "bg-dark-gray hover-bg-near-black"}}" 
  {{on "mousedown" @selectActiveTrack}}
  ...attributes 
>
  <div class="flex relative justify-between items-center">
    <span class="f3 code {{unless @isActive "yellow"}}">{{@track.order}}</span>
    <div class="grow-0 shrink-0">
      {{#if @track.isMaster}}
        <p class="tc pv2 ph3 ml2 f6 ttu bg-dark-gray yellow ba bw1 b--yellow w4 truncate f7">Main Output</p>
      {{/if}}
      {{#each @track.sourceNodeRecords as |trackNode|}}
        <SourceSelectButton
          class={{if @track.isMaster "ml3"}}
          @trackNode={{trackNode}} 
          @onToggleFilePicker={{@onToggleFilePicker}} 
        />
      {{/each}}
    </div>

    {{yield}}

    <div class="grow-1 basis-auto">
      {{#if @track.currentSequence.sequence}}
        <TrackSequencer 
          @sequence={{@track.currentSequence.sequence}}
          @stepIndex={{@track.stepIndex}}
          @onClickStep={{fn this.updateTrackSequence}}
          @isCurrentTrack={{@isActive}}
        />
      {{/if}}
    </div>
    <div class="grow-0 shrink-0 flex items-center">
      <ButtonPrimary
        class="truncate ma2 f7 flex items-center {{if (and @isActive @rightSidebarOpen) "light-yellow-button" "yellow-fill"}} {{if @track.isMaster "mr3"}}"
        {{on "click" @onToggleScripts}}
        @label="scripts"
      >
        {{svg-jar "fi-code" width="40px" height="20px"}}
        <span class="f7">script</span>
      </ButtonPrimary>
      {{#unless @track.isMaster}}
        <DropdownMenu 
          class="h-100 flex-grow {{if @isActive "dark-fill" "light-fill"}}"
          @items={{array 
            (hash label="delete" select=(fn this.deleteTrack)) 
            (hash label="duplicate" select=(fn this.duplicateTrack)) 
          }}
        />
      {{/unless}}
    </div>
  </div>
</div>