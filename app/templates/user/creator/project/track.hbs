{{#if @model.drumMenuOpen}}
  <DrumFilePicker
    @track={{@model}}
    @updateTrackTask={{updateTrackTask}}
  />
{{/if}}

<div class="w-100">
  {{#unless @model.isDeleted}}
    <p class="fw6">{{@model.id}}</p>
    <div class="flex flex-column bg-light-gray pa4 flex-wrap">
      <div class="flex">
        <NexusDial 
          @value={{@model.hits}} 
          @onChangeValue={{perform updateTrackTask "hits"}} 
          @min=0 
          @max={{this.maxSteps}}
        >
          {{@model.hits}}
        </NexusDial>
        <NexusDial 
          @value={{@model.steps}} 
          @onChangeValue={{perform updateTrackTask "steps"}} 
          @min=0 
          @max={{this.maxSteps}}
        >
          {{@model.steps}}
        </NexusDial>
        <NexusDial 
          @value={{@model.offset}} 
          @onChangeValue={{perform updateTrackTask "offset"}} 
          @min=0 
          @max={{this.maxSteps}}
        >
          {{@model.offset}}
        </NexusDial>
        
      </div>
      <div class="flex">
        {{#each @model.trackNodes as |trackNode idx|}}
          <div class="tc mh3">
            {{trackNode.nodeType}}
            {{#each trackNode.trackControls as |trackControl|}}
              <TrackControlWrapper 
                @sequence={{@model.sequence}}
                @trackControl={{trackControl}} 
                @controlArrayValue={{trackControl.controlArrayValue}} 
                @updateControl={{action "updateControl" trackControl}} 
              />
            {{/each}}
          </div>
        {{/each}}
      </div>
    </div>
  {{/unless}}
  
  {{#if @model.initScript}}
    <ScriptEditor @scriptModel={{@model.initScript}}/>
  {{/if}}

  {{#if @model.onstepScript}}
    <ScriptEditor @scriptModel={{@model.onstepScript}}/>
  {{/if}}
</div>

{{outlet}}